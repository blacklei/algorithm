# Bit Manipulation

### Bit Manipulation By Hand

- ^ XOR
- ~ NOT

```java
0110 + 0010 = 1000, 0011 * 0101 = 1111, 0110 + 0110 = 1100

0011 + 0010 = 0101, 0011 * 0011 = 1001, 0100 * 0011 = 1100

0110 - 0011 = 0011, 1101 >> 2 = 0011, 1101 ^ (~1101) = 1111

1000 - 0110 = 0010, 1101 ^ 0101 = 1000, 1011 & (~0 << 2 ) = 1000
```

### Bit Facts and Tricks

- 1s: a sequence of 1s
- 0s: a sequence of 0s

```java
x ^ 0s = x, x & 0s = 0, x | 0s = x

x ^ 1s = ~x, x & 1s = x, x | 1s = 1s

x ^ x = 0, x & x = x, x | x = x
```

### Two Complement and Negative Numbers

| Positive Values 	  | Negative Values 		        |
|-----------------|---|-----|-----------------|---|-----|
| 7               | 0 | 111 | -1              | 1 | 111 |
| 6               | 0 | 110 | -2              | 1 | 110 |
| 5               | 0 | 101 | -3              | 1 | 101 |
| 4               | 0 | 100 | -4              | 1 | 100 |
| 3               | 0 | 011 | -5              | 1 | 011 |
| 2               | 0 | 010 | -6              | 1 | 010 |
| 1               | 0 | 001 | -7              | 1 | 001 |
| 0               | 0 | 000 |                 |   |     |

先来理解下8位二进制数表示原理。先来理解下8位二进制数表示原理。从而可以延伸到32位，64位以及任意其他位数。

8位二进制正数表示范围

```
0000 0000 ~ 1111 1111
（0 ~ 255）
```

这个不难理解，那么如何表示负数呢？设计计算机的人就想，把最高位作为符号位，0表示正数，1表示负数。这样，8位二进制数表示范围就发生了变化：

```
负数：1 111 1111 ~ 1 000 0000 
    （-127 ~  -0)
正数：0 000 0000 ~ 0 111 1111
    （0 ~ 127）
```

但是如果在计算机中这样表示负数，那么相加减就很不方便。试想 -1 + 1 = 0 ，换成二进制就是：

```
  1 000 0001
+ 0 000 0001
-------------
  1 000 0010
```

计算机计算出来结果就是1 000 0010，这个结果等于-2，不是等于0，如果要保证结果正确，就需要修改计算机做加法的方式，非常不方便。于是设计计算机的人员就想到一个好方法，采用补码形式来表示有符号数。简单的说-1不是用1 000 0001来表示，而是用补码1 111 1111来表示，我们再来看下采用补码形式的 -1 + 1 的结果

```
  1 111 1111
+ 0 000 0001
----------------
 10 000 0000
```

因为是8位二进制数，所以舍弃最高位1，看下结果，非常完美，就是0

其实在上面的例子中，1 000 0001就是-1的原码，而1 111 1111就是-1的补码。这下原码和补码的定义就都有了。

那么补码怎么计算出来的呢？

```
1、正数：原码和补码一致
2、负数：原码取反，然后加1
```

例如求-1的补码：-1原码是1 000 0001，符号位保持不变，取反就是 1 111 1110 ，然后加1，就得到补码1 111 1111了。

大家会发现，-1的补码还可以这么求：1取反（包括符号位），然后加1，其实也能得到-1的补码。在程序中，求一个数的相反数，如果看到这样的写法 ~num + 1，其实就是这个原理了。我个人还是更喜欢直接用 -1 * num，这样更通俗易懂。

come from: http://www.01happy.com/computer-true-code-complement-code/